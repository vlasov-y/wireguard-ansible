- name: "{{ network }} : Configure firewalld"
  include_tasks: firewalld.yml
  when: _firewalld_enabled.stdout|bool

- name: "{{ network }} : Print public keys"
  debug:
    msg: "{{ public_key }}"

- name: "{{ network }} : Add route table"
  become: yes
  blockinfile:
    marker: "# {mark} Table for wireguard network {{ network }}"
    path: /etc/iproute2/rt_tables
    block: "{{ rt_table.id }}    {{ rt_table.name }}"

- name: "{{ network }} : Save configuration"
  include_tasks: config_save.yml

- name: "{{ network }} : Proxy domains configuration"
  include_tasks: proxy.yml
  when: network in wireguard_proxy_domains
